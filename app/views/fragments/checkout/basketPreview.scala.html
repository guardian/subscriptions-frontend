@(subscriptionProductsOpt: Option[Seq[model.zuora.SubscriptionProduct]] = None)

@import model.zuora.BillingFrequency
@import utils.Prices._

@priceOption(product: model.zuora.SubscriptionProduct, descriptionSuffix: String, isChecked: Boolean = false) = {
    <label class="option">
        <span class="option__input">
            <input
                type="radio" name="ratePlanId"
                data-option-mirror-label="@product.price.pretty @descriptionSuffix"
                value="@product.ratePlanId"@if(isChecked){ checked}
            >
        </span>
        <span class="option__label">@product.price.pretty @descriptionSuffix</span>
    </label>
}

<div class="basket-preview@if(subscriptionProductsOpt.nonEmpty){ basket-preview--products}">
    <h3 class="basket-preview__title">You've chosen:</h3>
    <div class="basket-preview__image">
        <img src="@controllers.CachedAssets.hashedPathFor("images/digital-pack.png")" alt="Digital Pack">
    </div>

    <div class="basket-preview__product">
        <span class="basket-preview__product__title">
            Digital Pack
        </span>
        <span class="basket-preview__product__caption">
            (Daily Edition / Guardian App Premium Tier)
        </span>
        @for(subscriptionProducts <- subscriptionProductsOpt) {
            @subscriptionProducts.find(_.frequency == BillingFrequency.Month).map { product =>
                <span class="basket-preview__product__payment js-option-mirror-value">
                    @product.price.pretty every month
                </span>
            }
        }
    </div>

    @for(subscriptionProducts <- subscriptionProductsOpt) {
        <div class="basket-preview__toggle">
            <button class="text-button u-button-reset js-toggle" data-toggle="change-payment-frequency">
                Change payment frequency
            </button>
        </div>
        <fieldset class="basket-preview__options is-hidden js-option-mirror-group" id="change-payment-frequency">
            @subscriptionProducts.find(_.frequency == BillingFrequency.Month).map { product =>
                @priceOption(product, "every month", isChecked=true)
            }
            @subscriptionProducts.find(_.frequency == BillingFrequency.Quarter).map { product =>
                @priceOption(product, "every 3 months")
            }
            @subscriptionProducts.find(_.frequency == BillingFrequency.Annual).map { product =>
                @priceOption(product, "every 12 months")
            }
        </fieldset>
    }
</div>
